<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Web sepak bola</title>
  <link rel="stylesheet" href="./vendor/css/materialize.min.css">
  <link rel="stylesheet" href="./assets/css/main.css">
</head>
<body>

  <!-- navbar -->
  <nav class="white z-depth-0 nav-component">
    <div class="nav-wrapper container">
      <a href="#home" class="brand-logo black-text" id="logo">
        EPL
      </a>
      <a href="#" style="font-size:2rem" class="sidenav-trigger black-text" data-target="mobile-nav">
        â˜°
      </a>

      <!-- topnav -->
      <ul class="topnav right hide-on-med-and-down">
        <li><a href="./index.html" class="waves-effect black-text">Klasemen</a></li>
        <li><a href="" class="waves-effect black-text">Jadwal</a></li>
        <li><a href="" class="waves-effect black-text">My Team</a></li>
      </ul>
      
      <!-- sidenav -->
      <ul class="sidenav" id="mobile-nav">
        <li><a href="./index.html" class="waves-effect black-text">Klasemen</a></li>
        <li><a href="#" class="waves-effect black-text">Jadwal</a></li>
        <li><a href="#" class="waves-effect black-text">My Team</a></li>
      </ul>
    </div>
  </nav>
  <!-- navbar -->

  <!-- content -->
  <div class="container" id="content">
    
    <h5>Klasemen Liga Inggris</h5>

    <ul class="collection"></ul>
  </div>


  <!-- materialize -->
  <script src="./vendor/js/materialize.min.js"></script>
  <script src="./assets/js/navbar.js"></script> 
  <script src="./assets/js/api.js"></script>
  <script src="./assets/js/register-sw.js"></script>
  <script>
    const setupKlasemen = async () => {
      const contentDOM = document.querySelector('#content .collection');
      let contentHTML = '';
      const data = await getKlasemen();
      data.standings[0].table.forEach(row => {
        contentHTML += `
          <li 
            class="collection-item avatar" 
            onclick="location.href = './team.html?id=${row.team.id}'"
            style="cursor: pointer"
            >
            <img src="${safeUrl(row.team.crestUrl)}" alt="" class="circle" width="50">
            <span class="title">${row.team.name}</span>
            <p>
              Posisi ${row.position} <br/>
              Poin ${row.points}
            </p>
          </li>`;
      });
      contentDOM.innerHTML = contentHTML;
    };

    // semua fungsi saat load dijalankan disini
    const init = async () => {
      await setupKlasemen();
    };

    // fungsi berasal dari register-sw.js
    // menjalankan init() setelah service worker terdaftar
    registerServiceWorker(init);
  </script>
</body>
</html>